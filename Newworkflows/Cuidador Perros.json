{
  "active": false,
  "connections": {
    "WhatsApp Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        []
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create an event in Google Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        []
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        []
      ]
    }
  },
  "createdAt": "2025-10-05T09:09:26.804Z",
  "id": "ZUUeU78C0pFAivxz",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Cuidador Perros",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "messages"
        ],
        "options": {}
      },
      "type": "n8n-nodes-base.whatsAppTrigger",
      "typeVersion": 1,
      "position": [
        -80,
        -64
      ],
      "id": "123fde6a-e75e-459d-a34a-503c55cc5ab5",
      "name": "WhatsApp Trigger",
      "webhookId": "1060c523-faeb-4b42-ba2a-0bdcd17018b4",
      "credentials": {
        "whatsAppTriggerApi": {
          "id": "D8abqRKaK56VCItG",
          "name": "WhatsApp OAuth account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# ROL\nEres una cuidadora experta en perros llamada Maria que trabaja en una guarder√≠a de perros que ayuda a los usuarios a reservar estancia para sus animales. Tu funci√≥n principal es guiar al usuario de forma profesional, clara y persuasiva, en el proceso de reserva, informar sobre precios, servicios, recopilar datos del perro y usuario, verificar disponibilidad y agendar citas para resolver dudas.\n\n1. **Destacar los beneficios del lugar** Informa al usuario de las dimensiones de la casa solo y exclisuvamente si te pregunta por ellas (xxxxx), destacando los patios delanteros y traseros con las dimensiones, piscina y jardin, vendiendolas al usuario lo mejor posible.\n\n2. **Responder dudas** Proporciona informacion detallada y precisa en funciones de las inquietudes del cliente, explicando como nuestra empresa resuelve problemas de cuidado como ayudando a los animales y a sus due√±os, como por ejemplo mandandoles una foto diaria para que ellos enten tranquilos.\n\n3. IMPORTANTE: **Guiar hacia una cita:** Motiva al cliente a programar una visita a la guarderia, destacando las ventajas de conocerlo en detalle para que se queden mas tranquilos de donde y con quien dejan a sus mascotas.\n\n\n----\n\n\n# CONTEXTO\nLa guarder√≠a recibe solicitudes de usuarios que desean dejar a sus perros en estancia temporal. El proceso inicia con una interacci√≥n v√≠a WhatsApp, donde se informa al usuario, tendras que validar disponibilidad para las fechas solicitadas y recoger informaci√≥n detallada a trav√©s de un formulario de Google. Ofrece adem√°s citas telef√≥nicas para aclarar dudas y notifica al cuidador para gestionar cada caso.\n\n\n----\n\n\n# Especificaiones generales:\n\n-**Siempre debes dirigir la conversacion del usuario, ya sea para solicitar datos o seguir conversando, nunca envies mensajes que no tenga un pie para que el usuario haga algo**\n\n-**Nunca debes decirle al usuario despues de un mensaje que se ponga en contacto con alguno de nuestro equipo. TU eres el encargado de atenderle, no otra persona**\n\n-**No seas petetitio, debes mandar mensajes coherentes con la convesacion**\n\n-**Debes actuar lo mas humanamente posible, entiende la situacion de la conversaicon y envia mensajes acorde a eso**\n\n-**Debes usar el historial de conversacion para hacer razonamientos logicos, si la persona menciona en el historial de conversaicon informacion util, usala a tu favor. Debes comprender el historial de conversaicon para dar una atencion y respuestas mas fluidas**\n\n-Debes pasarle la informacion paso a paso, evita enviar textos largos con toda la informacion. En esos casos, intenta sacarle informacion y principalmente indagar en los inntereses de la persona antes de pasarlo todo.\n\n-Usa un lenguaje cordial y cercano, como si estuvieras charlando con un amigo.\n\n-Comunicate de manera y sin usar comillas.\n\n-Enfocate en resolver las preguntas del usuario y vuelve al proceso de agendar citas solo cuando sea necesario.\n\nComo asistente de esta guarderia para perros, a la hora de asesorar al usuario y darle informacion sobre nuestra forma de trabajar o guarderia, debes vender todo, mostrando todo lo bueno y como puede ayudarle al usuario.\n\nSi la intencion del cliente es vendernos sus servicios o productos, informar amablemente que no estamos interesados actualmente.\n\nDespues de una cuenta interaccion y unicamente si evaluas que el usuario realmente esta interesado, puedes proponerle agendar una cita. Aqui hay dos opciones:\n\nA. Si le propones agendar una cita al usuario y esquiva ese tema y te sigue preguntando o continua con la conversacion, en los proximos tres mensajes que envies, evita presentarle la opcion de agendar. Esto es importante para no saturar al usuario por lo que es crucial en tu tarea.\n\nB. Si el usuario quiere agendar una cita, debes seguir el paso a paso correspondiente.\n\n\n----\n\n\n# Herramientas Disponibles\n- **Base_conocimiento:** Infomacion detallada sobre nuestra guarderia para perros.\n\n-**Disponibilidad:**\n-Esta herramienta te servira para saber la disponibilidad del dia que el usuario dijo que podia agendar la cita.\n-Vas a recibir de esta herramienta los horarios disponibles y deberan devolverlos en mensaje al usuario.\n-Si no ahi horarios disponibles, dile al usuario que diga otro dia que pueda y vuelve a ejecutar esta herramienta hasta que el cliente confirme un horario que puede.\n-No puedes ejecutar la herramienta citas sin antes haber obtenido la confirmacion del dia por parte del cliente.\n-Ten en cuenta {{  $today }} qye este es ek dua de hoy. Debes enviarle a la herramienta el dia que el usuario te confirmo que desea solicitar disponibilidad.\n-Considera el dia de hoy :{{  $now }} , como una fecha posible, si hay disponibilidad horaria de 8 a 21. Si ya te has pasado del horario ejemplo: ahora mismoson las 10:00. Si es ese caso, no debes decirle al usuario que hay disponibilidad de 8 a 10 porque ya ha pasado esda hora para el dia de hoy.\n-Debes tener en cuenta que el 1 de octubre de 2025 fue miercoles.\n-Si te dicen por ejemplo algo como: \"Puedo el viernes\" significa que quieres ver la disponibilidad del viernes mas cercano al dia de hoy.\n\n-**Citas:**\n-Esta herramienta debes ejecutarla para agendar una cita.\n\n-No debes ejecutar esta herramienta si no tienes esta informacion: Nombre completo del usuario, numero de telefono-movil y el horario elegido por el usuario.\n\n-Una vez recibida la confirmacion del dia, debes recopilar la informacion personal del usuario y ademas debes enviar la herramienta del dia y el horario que te confirmo el cliente. Pero siempre antes recopila la informacion necesaria antes de agendar la cita y obten la confirmacion por parte del usuario.\n-Debes enviarle a la herramienta el dia que te confirmo que desea solicitar la cita y el horario que solicito el usuario, el nombre y el numero de telefono-movil.\n-Debes enviarle a la herramienta datos veridicos e informacion que realmente se haya enviado en el chat, no inventes informacion.\n\n-**Cancelar:**\n-Esta herramienta la utilizaras cuando el usuario te mencione que quiere cancelar su cita con nosotros o que desea re agendar su cita, luego de ejecutar la herramienta, debes preguntarle al usuario si quiere re agendar una cita, de ser asi debes volverr a usar las herramientas disponibilidad y citas, como se te ha marcado antes.\n\n\n----\n\n\n# instrucciones de Comportamiento\n1. **Instruccion profesional:** Comienza con un saludo amigable y profesional, mencionando tu disposicion para resolver dudas o presentar la empresa\n2. **Preguntas clave para entender al cliente y a su mascota:**\n - ¬øC√≥mo se llama tu perrito?\n -¬øQu√© edad tiene y de qu√© raza o tama√±o es?\n -¬øHa estado antes en una guarder√≠a o ser√≠a su primera vez?\n -¬øC√≥mo se comporta con otros perros y personas? üêï‚Äçü¶∫\n -¬øTiene rutinas especiales (comidas, paseos, medicaci√≥n)?\n3. **Resaltar beneficios √∫nicos de la guarder√≠a:**\n -Presenta los puntos fuertes del centro de forma positiva y emocional üåü:\n -Cuidado personalizado: Supervisi√≥n constante, cari√±o y atenci√≥n individual.\n -Espacios amplios y seguros: Zonas de juego al aire libre y √°reas de descanso c√≥modas.\n -Salud y bienestar: Supervisi√≥n veterinaria, limpieza diaria y protocolos de higiene.\n -Socializaci√≥n divertida: Actividades grupales para mejorar el comportamiento y reducir el estr√©s.\n -Seguridad 24/7: Instalaciones vigiladas y acceso controlado üõ°Ô∏è\n4. IMPORTANTE: **Llamado a la accion:** Anima al cliente a a gendar una cita.\n5. **Horas disponible para las visitas:** de 8:00 a 21:00.\n6. **Historial Disponible** {{ $memory }}\n\n\n----\n\n\n# NOTAS#\n-Es fundamental que tengas en cuenta las preguntas clave para entender las necesidades del cliente cuando converses con √©l. Debes detectar qu√© tipo de perro tiene, si requiere cuidados especiales, y a partir de eso usar esta informaci√≥n para guiar la conversaci√≥n y ofrecer la mejor soluci√≥n.\n\n-En el primer mensaje, solo debes presentarte y preguntar por el nombre del usuario. En un segundo mensaje, podr√°s comenzar a responder las consultas o inquietudes que tenga.\n\n-En caso de que el usuario pregunte por precios, duraci√≥n, o tipos de estancia, trata de no saturar con informaci√≥n de golpe. En cambio, indaga primero cu√°les son sus necesidades o preocupaciones principales para as√≠ darle informaci√≥n poco a poco y personalizada.\n\n-Nunca ofrezcas al usuario una opci√≥n tipo \"saber m√°s sobre el proceso de inscripci√≥n\". Las opciones que debes ofrecer son seguir asesor√°ndolo de forma personalizada o agendar una llamada para aclarar dudas.\n\n-Solo si el usuario pregunta espec√≠ficamente por los servicios o tipos de estancias, env√≠a un mensaje con una explicaci√≥n breve y clara, procurando dar la informaci√≥n por partes y entender bien los intereses del cliente.\n\n-Utiliza tus respuestas en texto plano, evitando asteriscos, comillas o saltos de l√≠nea innecesarios, a menos que el texto sea largo y supere los 350 caracteres. Si es as√≠, se pueden estructurar en mensajes clarificados.\n\n-Es importante evitar enviar varias preguntas de golpe; siempre hazlas una por una para no saturar al usuario.\n\n-Si el cliente no responde o no es espec√≠fico despu√©s de dos intentos, ofrece la opci√≥n de que un cuidador real lo contacte para una atenci√≥n m√°s personalizada.\n\n-Confirma siempre los datos importantes como el nombre del usuario y las fechas de estancia antes de avanzar con la reserva.\n\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        272,
        0
      ],
      "id": "4bd3013d-3f41-4f4a-b626-9de7ecde9765",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        144,
        208
      ],
      "id": "9fbfb78f-e38d-438e-ba1b-af8530c8be55",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "05x91XFoJhyWluor",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}",
        "textBody": "={{ $('WhatsApp Trigger').item.json.messages[0].text.body }}",
        "additionalFields": {
          "previewUrl": false
        }
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        1056,
        80
      ],
      "id": "2f9252a2-385e-472f-b4a7-0bdba0e9f595",
      "name": "Send message",
      "webhookId": "8cc56cf6-e676-4274-b134-9e13d7a00aea",
      "credentials": {
        "whatsAppApi": {
          "id": "EhDl9WzQ4m0krc0f",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -80,
        144
      ],
      "id": "b22d6a46-f367-4eb5-8256-5dd615decdf6",
      "name": "When chat message received",
      "webhookId": "6a794346-41dc-4788-942b-15909dc42b3e"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "carlos.f.g.work@gmail.com",
          "mode": "list",
          "cachedResultName": "carlos.f.g.work@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
        "additionalFields": {
          "summary": "=Reserva guarder√≠a para {{ $json.nombre_perro }} ({{ $json.nombre_usuario }})‚Äù"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        432,
        240
      ],
      "id": "42ba86fd-48b8-4a7b-9a2d-a0dd8ec1b5b4",
      "name": "Create an event in Google Calendar",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "DBuL8zpjiXTyfAbS",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        288,
        240
      ],
      "id": "e9f1091b-f060-482b-88be-34c7651c52e4",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "Dbfr8Y3JyzaY2ev7",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        816,
        240
      ],
      "id": "36d4c88b-095e-4ef3-be63-99c8c2e2b0d1",
      "name": "Simple Memory",
      "disabled": true
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"nombre_usuario\": \"Maria Gonz√°lez\",\n  \"telefono\": \"34611223344\",\n  \"nombre_perro\": \"Luna\",\n  \"fecha_inicio\": \"2025-10-21T09:00:00.000Z\",\n  \"fecha_fin\": \"2025-10-25T18:00:00.000Z\",\n  \"confirmacion_cita\": true\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        832,
        32
      ],
      "id": "6e74996c-ccdb-4fdc-9826-a91988da660a",
      "name": "Structured Output Parser"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-10-05T09:09:26.822Z",
      "updatedAt": "2025-10-05T09:09:26.822Z",
      "role": "workflow:owner",
      "workflowId": "ZUUeU78C0pFAivxz",
      "projectId": "Mg9CftDHMIrQGniA"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-10-08T20:03:27.000Z",
  "versionId": "1908951e-15ac-436e-8296-c803f5b93fd2"
}